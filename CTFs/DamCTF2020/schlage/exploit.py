#!/bin/python3

from pwn import *
import subprocess

r = remote('chals.damctf.xyz', 31932)

r.recvuntil(b'> ')
r.sendline(b'3')
r.recvuntil(b'> ')
r.sendline(b'3449466328')
r.recvuntil(b'> ')
r.sendline(b'1')
r.recvuntil(b'> ')
r.sendline(b'99')
r.recvuntil(b'> ')
r.sendline(b'5')
r.recvuntil(b'> ')
r.sendline(b'1413036362')

r.recvuntil(b'> ')
r.sendline(b'2')
r.recvuntil(b'I wonder what it means?\n')
seed = r.recvline().decode().rstrip()
proc = subprocess.Popen(['./num_gen', seed], stdout=subprocess.PIPE)
random_number = proc.stdout.read().rstrip()
r.recvuntil(b'> ')
r.sendline(random_number)

pin4_result = ""
while pin4_result != b'Such a cool sentence!\n':
    r.recvuntil(b'> ')
    r.sendline(b'4')
    r.recvuntil(b"What's your favorite sentence?\n")
    r.sendline(b')))')
    pin4_result = r.recvline()

r.recvuntil(b'troubles:\n')
print(r.recvline().decode())

r.close()
